Программа на Python для автоматического распознавания автомобильных номеров формата РФ с использованием камеры (USB/webcam).  
В основе — **YOLOv8** (детекция табличек) + **PaddleOCR** (распознавание текста) + система стабилизации и фильтрации.

## Возможности
- Поддержка камер (USB/IP).
- Детекция гос.номеров (YOLOv8).
- Распознавание текста с коррекцией перспективы и предобработкой.
- Валидация формата российских номеров (ГОСТ).
- Стабилизация распознавания.
- Кулдаун между повторными фиксациями (по умолчанию 15 секунд).
- Ведение истории обнаружений в CSV (с ограничением на `N_RECENT` записей).
- Отладочный режим: отображение сырых OCR-кандидатов и причин отбраковки.

## Установка

### 1. Клонировать проект или скачать файлы
Сохрани `main.py` и файл весов YOLO (например, `best.pt`) в рабочую папку.

### 2. Установить зависимости
pip install paddlepaddle==2.6.2 paddleocr==2.9.1
pip install ultralytics opencv-python numpy

Если у тебя есть NVIDIA GPU и CUDA — установи paddlepaddle-gpu==2.6.2 вместо CPU-версии.

Конфигурация:
VIDEO_SOURCE - индекс камеры/путь к видео
YOLO_WEIGHTS - файл весов YOLO (детектор табличек)
CSV_PATH - определяет, где хранится CSV
CSV_FIELDS - имена колонок
CSV_DELIM - разделитель
CSV_ENC - кодировка с BOM, чтобы Excel распознал UTF-8
DET_CONF - порог уверенности у YOLO (минимальная вероятность для детекции)
N_RECENT - сколько последних времён храненить для номера
COOLDOWN_SECONDS - минимальный интервал между повторными записями одного номера
STABLE_WINDOW - окно времени стабилизации для одного bbox (секунды)
REPEAT_VOTES - сколько одинаковых чтений подряд требуется
MIN_OCR_CONF - минимальная уверенность OCR
GRID - «квантование» центра bbox (пиксели) для устойчивого ключа
DEBUG - вкл/выкл выпрямление
RECTIFY_ENABLED - вывод подсказок
SHOW_RAW_OCR - вывод «сырых» OCR-кандидатов
SHOW_REASONS - вывод причин отбраковки

## Логика работы
1. YOLOv8 находит номера на кадре.
2. Для каждого bbox:
  выполняется выравнивание таблички (perspective transform),
  создаётся несколько вариантов изображения (оригинал / контрастный / бинарный),
  PaddleOCR распознаёт текст по всем вариантам,
  выбирается лучший результат по confidence.
3. Результат нормализуется (кириллица -> латиница) и проверяется на соответствие формату РФ.
4. Для защиты от «скачков» работает стабилизация: номер записывается в CSV только если подтверждён (несколько подряд или по таймеру).
5. В CSV сохраняется первый момент появления и список последних N_RECENT фиксаций (с учётом COOLDOWN_SECONDS).

